"use strict";(function(){const i="/en.search-data.min.2223c056f0866ac502c8f286d23609fff853cc94bc510be6f05ac01def9e6fd2.json",a=Object.assign({},{doc:{id:"id",field:["title","content","logo"],store:["title","href","section","content","logo","rgb","color"]}}),e=document.querySelector("#search-input"),t=document.querySelector("#search-results");if(!e)return;e.addEventListener("focus",n),e.addEventListener("keyup",s),document.addEventListener("keypress",r);function r(t){if(e===document.activeElement)return;if(l())return;const n=String.fromCharCode(t.charCode);if(!c(n))return;e.focus(),t.preventDefault()}function c(t){const n=e.getAttribute("data-hotkeys")||"";return n.indexOf(t)>=0}function n(){e.removeEventListener("focus",n),e.required=!0,fetch(i).then(e=>e.json()).then(e=>{window.bookSearchIndex=FlexSearch.create("balance",a),window.bookSearchIndex.add(e)}).then(()=>e.required=!1).then(s)}function s(){for(;t.firstChild;)t.removeChild(t.firstChild);if(!e.value)return;const n=window.bookSearchIndex.search(e.value,10);n.forEach(function(n){const s=o('<li><a href></a><small></small><span class="found"></span></li>'),i=s.querySelector("a"),l=s.querySelector("small"),d=s.querySelector("span");if(n.logo){const e=o('<img src="" class="logo visible-img">');e.src=n.logo,i.appendChild(e)}if(n.rgb){const e=n.rgb.split(",");setColors(e,!1,s)}n.color&&colors[n.color]&&setColors(colors[n.color],!1,s),i.href=n.href,i.innerHTML+=n.title,l.textContent=n.section;function c(e){return e.toLowerCase()}const a=c(n.content),r=c(e.value);if(a.includes(r)){const t=a.indexOf(r),s=Math.max(t-20,0),o=Math.min(t+e.value.length+30,a.length),i=n.content.slice(s,o).split(" ").slice(s>0?1:0,o<n.content.length-30?-1:void 0).join(" ");d.innerHTML=i.replace(new RegExp(r,"gi"),"<mark>$&</mark>")+"..."}t.appendChild(s)})}function o(e){const t=document.createElement("div");return t.innerHTML=e,t.firstChild}function l(){return document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement}})()