'use strict';(function(){const g='/en.search-data.min.5d6e66fcba891c6bf754cbb7df95e671a2d74c72ce39a55c919826c9e50990cf.json',h=Object.assign({},{doc:{id:'id',field:['title','content'],store:['title','href','section','content']}}),a=document.querySelector('#search-input'),b=document.querySelector('#search-results');if(!a)return;a.addEventListener('focus',c),a.addEventListener('keyup',d),document.addEventListener('keypress',e);function e(b){if(a===document.activeElement)return;if(j())return;const c=String.fromCharCode(b.charCode);if(!f(c))return;a.focus(),b.preventDefault()}function f(b){const c=a.getAttribute('data-hotkeys')||'';return c.indexOf(b)>=0}function c(){a.removeEventListener('focus',c),a.required=!0,fetch(g).then(a=>a.json()).then(a=>{window.bookSearchIndex=FlexSearch.create('balance',h),window.bookSearchIndex.add(a)}).then(()=>a.required=!1).then(d)}function d(){while(b.firstChild)b.removeChild(b.firstChild);if(!a.value)return;const c=window.bookSearchIndex.search(a.value,10);c.forEach(function(c){const d=i('<li><a href></a><small></small><span class="found"></span></li>'),g=d.querySelector('a'),j=d.querySelector('small'),k=d.querySelector('span');g.href=c.href,g.textContent=c.title,j.textContent=c.section;function h(a){return a.toLowerCase()}const e=h(c.content),f=h(a.value);if(e.includes(f)){const b=e.indexOf(f),d=Math.max(b-20,0),g=Math.min(b+a.value.length+30,e.length),h=c.content.slice(d,g).split(' ').slice(d>0?1:0,g<c.content.length-30?-1:void 0).join(' ');k.innerHTML=h.replace(new RegExp(f,'gi'),'<mark>$&</mark>')+'...'}b.appendChild(d)})}function i(b){const a=document.createElement('div');return a.innerHTML=b,a.firstChild}function j(){return document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement}})()